<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Practical example: Logistic Mixed Effects Model with Interaction Term • ggeffects</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Practical example: Logistic Mixed Effects Model with Interaction Term">
<meta property="og:description" content="ggeffects">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ggeffects</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.14.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Introductions
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/ggeffects.html">Marginal Effects of Regression Models</a>
    </li>
    <li>
      <a href="../articles/introduction_effectsatvalues.html">Marginal Effects at Specific Values</a>
    </li>
    <li>
      <a href="../articles/introduction_randomeffects.html">Marginal Effects for Random Effects Models</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Plotting
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/introduction_plotmethod.html">Plotting Marginal Effects</a>
    </li>
    <li>
      <a href="../articles/introduction_plotcustomize.html">Customize Plot Appearance</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Practical Examples
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/practical_logisticmixedmodel.html">Logistic Mixed Effects Model with Interaction Term</a>
    </li>
    <li>
      <a href="../articles/practical_robustestimation.html">(Cluster) Robust Standard Errors</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Technical Details
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/technical_differencepredictemmeans.html">Difference between ggpredict() and ggemmeans()</a>
    </li>
    <li>
      <a href="../articles/technical_stata.html">Different Output between Stata and ggeffects</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/strengejacke/ggeffects/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Practical example: Logistic Mixed Effects Model with Interaction Term</h1>
                        <h4 class="author">Daniel Lüdecke</h4>
            
            <h4 class="date">2020-06-09</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/strengejacke/ggeffects/blob/master/vignettes/practical_logisticmixedmodel.Rmd"><code>vignettes/practical_logisticmixedmodel.Rmd</code></a></small>
      <div class="hidden name"><code>practical_logisticmixedmodel.Rmd</code></div>

    </div>

    
    
<p>This vignette demonstrate how to use <em>ggeffects</em> to compute and plot marginal effects of a logistic regression model. To cover some frequently asked questions by users, we’ll fit a mixed model, inlcuding an interaction term and a quadratic resp. spline term. A general introduction into the package usage can be found in the vignette <a href="ggeffects.html">marginal effects of regression model</a>.</p>
<p>First, we load the required packages and create a sample data set with a binomial and continuous variable as predictor as well as a group factor. To avoid convergence warnings, the continuous variable is standardized.</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">magrittr</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ggeffects</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">sjmisc</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">lme4</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">splines</span>)

<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">123</span>)

<span class="no">dat</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(
  <span class="kw">outcome</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span>(<span class="kw">n</span> <span class="kw">=</span> <span class="fl">100</span>, <span class="kw">size</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">prob</span> <span class="kw">=</span> <span class="fl">0.35</span>),
  <span class="kw">var_binom</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span>(<span class="kw">n</span> <span class="kw">=</span> <span class="fl">100</span>, <span class="kw">size</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">prob</span> <span class="kw">=</span> <span class="fl">0.2</span>)),
  <span class="kw">var_cont</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="kw">n</span> <span class="kw">=</span> <span class="fl">100</span>, <span class="kw">mean</span> <span class="kw">=</span> <span class="fl">10</span>, <span class="kw">sd</span> <span class="kw">=</span> <span class="fl">7</span>),
  <span class="kw">group</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="no">letters</span>[<span class="fl">1</span>:<span class="fl">4</span>], <span class="kw">size</span> <span class="kw">=</span> <span class="fl">100</span>, <span class="kw">replace</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
)

<span class="no">dat</span>$<span class="no">var_cont</span> <span class="kw">&lt;-</span> <span class="kw pkg">sjmisc</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/sjmisc/man/std.html">std</a></span>(<span class="no">dat</span>$<span class="no">var_cont</span>)</pre></body></html></div>
<div id="simple-logistic-mixed-effects-model" class="section level2">
<h2 class="hasAnchor">
<a href="#simple-logistic-mixed-effects-model" class="anchor"></a>Simple Logistic Mixed Effects Model</h2>
<p>We start by fitting a simple mixed effects model.</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="no">m1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/glmer.html">glmer</a></span>(
  <span class="no">outcome</span> ~ <span class="no">var_binom</span> + <span class="no">var_cont</span> + (<span class="fl">1</span> <span class="kw">|</span> <span class="no">group</span>),
  <span class="kw">data</span> <span class="kw">=</span> <span class="no">dat</span>,
  <span class="kw">family</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html">binomial</a></span>(<span class="kw">link</span> <span class="kw">=</span> <span class="st">"logit"</span>)
)</pre></body></html></div>
<p>For a discrete variable, marginal effects for all levels are calculated by default. For continuous variables, a pretty range of values is generated. See more details about value ranges in the vignette <a href="introduction_effectsatvalues.html">marginal effects at specific values</a>.</p>
<p>For logistic regression models, since <em>ggeffects</em> returns marginal effects on the response scale, the predicted values are predicted <em>probabilities</em>. Furthermore, for mixed models, the predicted values are typically at the <em>population</em> level, not group-specific.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="fu"><a href="../reference/ggpredict.html">ggpredict</a></span>(<span class="no">m1</span>, <span class="st">"var_binom"</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt; # Predicted probabilities of outcome</span>
<span class="co">#&gt; # x = var_binom</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; x | Predicted |   SE |       95% CI</span>
<span class="co">#&gt; -----------------------------------</span>
<span class="co">#&gt; 0 |      0.37 | 0.29 | [0.25, 0.51]</span>
<span class="co">#&gt; 1 |      0.38 | 0.52 | [0.18, 0.63]</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Adjusted for:</span>
<span class="co">#&gt; * var_cont = -0.00</span>
<span class="co">#&gt; *    group = 0 (population-level)</span>
<span class="co">#&gt; Standard errors are on link-scale (untransformed).</span>

<span class="fu"><a href="../reference/ggpredict.html">ggpredict</a></span>(<span class="no">m1</span>, <span class="st">"var_cont"</span>)
<span class="co">#&gt; Data were 'prettified'. Consider using `terms="var_cont [all]"` to get smooth plots.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; # Predicted probabilities of outcome</span>
<span class="co">#&gt; # x = var_cont</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     x | Predicted |   SE |       95% CI</span>
<span class="co">#&gt; ---------------------------------------</span>
<span class="co">#&gt; -2.50 |      0.34 | 0.62 | [0.13, 0.63]</span>
<span class="co">#&gt; -2.00 |      0.34 | 0.53 | [0.16, 0.59]</span>
<span class="co">#&gt; -1.00 |      0.36 | 0.37 | [0.21, 0.53]</span>
<span class="co">#&gt;  0.00 |      0.37 | 0.29 | [0.25, 0.51]</span>
<span class="co">#&gt;  0.50 |      0.38 | 0.31 | [0.25, 0.52]</span>
<span class="co">#&gt;  1.00 |      0.38 | 0.35 | [0.24, 0.55]</span>
<span class="co">#&gt;  2.00 |      0.40 | 0.51 | [0.19, 0.64]</span>
<span class="co">#&gt;  3.50 |      0.42 | 0.79 | [0.13, 0.77]</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Adjusted for:</span>
<span class="co">#&gt; * var_binom = 0</span>
<span class="co">#&gt; *     group = 0 (population-level)</span>
<span class="co">#&gt; Standard errors are on link-scale (untransformed).</span></pre></body></html></div>
<p>To plot marginal effects, simply plot the returned results or use the pipe.</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="co"># save marginal effects in an object and plot</span>
<span class="no">me</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/ggpredict.html">ggpredict</a></span>(<span class="no">m1</span>, <span class="st">"var_binom"</span>)
<span class="fu"><a href="../reference/plot.html">plot</a></span>(<span class="no">me</span>)</pre></body></html></div>
<p><img src="practical_logisticmixedmodel_files/figure-html/unnamed-chunk-4-1.png" width="672"></p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="co"># plot using the pipe</span>
<span class="fu"><a href="../reference/ggpredict.html">ggpredict</a></span>(<span class="no">m1</span>, <span class="st">"var_cont"</span>) <span class="kw">%&gt;%</span> <span class="fu"><a href="../reference/plot.html">plot</a></span>()</pre></body></html></div>
<p><img src="practical_logisticmixedmodel_files/figure-html/unnamed-chunk-4-2.png" width="672"></p>
</div>
<div id="logistic-mixed-effects-model-with-interaction-term" class="section level2">
<h2 class="hasAnchor">
<a href="#logistic-mixed-effects-model-with-interaction-term" class="anchor"></a>Logistic Mixed Effects Model with Interaction Term</h2>
<p>Next, we fit a model with an interaction between the binomial and continuous variable.</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="no">m2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/glmer.html">glmer</a></span>(
  <span class="no">outcome</span> ~ <span class="no">var_binom</span> * <span class="no">var_cont</span> + (<span class="fl">1</span> <span class="kw">|</span> <span class="no">group</span>),
  <span class="kw">data</span> <span class="kw">=</span> <span class="no">dat</span>,
  <span class="kw">family</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html">binomial</a></span>(<span class="kw">link</span> <span class="kw">=</span> <span class="st">"logit"</span>)
)</pre></body></html></div>
<p>To compute or plot marginal effects of interaction terms, simply specify these terms, i.e. the names of the variables, as character vector in the <code>terms</code>-argument. Since we have an interaction between <code>var_binom</code> and <code>var_cont</code>, the argument would be <code>terms = c("var_binom", "var_cont")</code>. However, the <em>first</em> variable in the <code>terms</code>-argument is used as predictor along the x-axis. Marginal effects are then plotted for specific values or at specific levels from the <em>second</em> variable.</p>
<p>If the second variable is a factor, marginal effects for each level are plotted. If the second variable is continuous, representative values are chosen (typically, mean +/- one SD, see <a href="introduction_effectsatvalues.html">marginal effects at specific values</a>).</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="fu"><a href="../reference/ggpredict.html">ggpredict</a></span>(<span class="no">m2</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"var_cont"</span>, <span class="st">"var_binom"</span>)) <span class="kw">%&gt;%</span> <span class="fu"><a href="../reference/plot.html">plot</a></span>()
<span class="co">#&gt; Data were 'prettified'. Consider using `terms="var_cont [all]"` to get smooth plots.</span></pre></body></html></div>
<p><img src="practical_logisticmixedmodel_files/figure-html/unnamed-chunk-6-1.png" width="672"></p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="fu"><a href="../reference/ggpredict.html">ggpredict</a></span>(<span class="no">m2</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"var_binom"</span>, <span class="st">"var_cont"</span>)) <span class="kw">%&gt;%</span> <span class="fu"><a href="../reference/plot.html">plot</a></span>()</pre></body></html></div>
<p><img src="practical_logisticmixedmodel_files/figure-html/unnamed-chunk-6-2.png" width="672"></p>
</div>
<div id="logistic-mixed-effects-model-with-quadratic-interaction-term" class="section level2">
<h2 class="hasAnchor">
<a href="#logistic-mixed-effects-model-with-quadratic-interaction-term" class="anchor"></a>Logistic Mixed Effects Model with quadratic Interaction Term</h2>
<p>Now we fit a model with interaction term, where the continuous variable is modelled as quadratic term.</p>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="no">m3</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/glmer.html">glmer</a></span>(
  <span class="no">outcome</span> ~ <span class="no">var_binom</span> * <span class="fu"><a href="https://rdrr.io/r/stats/poly.html">poly</a></span>(<span class="no">var_cont</span>, <span class="kw">degree</span> <span class="kw">=</span> <span class="fl">2</span>, <span class="kw">raw</span> <span class="kw">=</span> <span class="fl">TRUE</span>) + (<span class="fl">1</span> <span class="kw">|</span> <span class="no">group</span>),
  <span class="kw">data</span> <span class="kw">=</span> <span class="no">dat</span>,
  <span class="kw">family</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html">binomial</a></span>(<span class="kw">link</span> <span class="kw">=</span> <span class="st">"logit"</span>)
)</pre></body></html></div>
<p>Again, <em>ggeffect</em> automatically plots all high-order terms when these are specified in the <code>terms</code>-argument. Hence, the function call is identical to the previous examples with interaction terms, which had no polynomial term included.</p>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="fu"><a href="../reference/ggpredict.html">ggpredict</a></span>(<span class="no">m3</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"var_cont"</span>, <span class="st">"var_binom"</span>)) <span class="kw">%&gt;%</span> <span class="fu"><a href="../reference/plot.html">plot</a></span>()
<span class="co">#&gt; Model contains splines or polynomial terms. Consider using `terms="var_cont [all]"` to get smooth plots. See also package-vignette 'Marginal Effects at Specific Values'.</span></pre></body></html></div>
<p><img src="practical_logisticmixedmodel_files/figure-html/unnamed-chunk-8-1.png" width="672"></p>
<p>As you can see, <em>ggeffects</em> also returned a message indicated that the plot may not look very smooth due to the involvement of polynomial or spline terms:</p>
<blockquote>
<p>Model contains splines or polynomial terms. Consider using <code>terms="var_cont [all]"</code> to get smooth plots. See also package-vignette ‘Marginal Effects at Specific Values’.</p>
</blockquote>
<p>This is because for mixed models, computing marginal effects with spline or polynomial terms may lead to memory allocation problems. If you are sure that this will not happen, add the <code>[all]</code>-tag to the <code>terms</code>-argument, as described in the message:</p>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="fu"><a href="../reference/ggpredict.html">ggpredict</a></span>(<span class="no">m3</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"var_cont [all]"</span>, <span class="st">"var_binom"</span>)) <span class="kw">%&gt;%</span> <span class="fu"><a href="../reference/plot.html">plot</a></span>()</pre></body></html></div>
<p><img src="practical_logisticmixedmodel_files/figure-html/unnamed-chunk-9-1.png" width="672"></p>
<p>The above plot produces much smoother curves.</p>
</div>
<div id="logistic-mixed-effects-model-with-three-way-interaction" class="section level2">
<h2 class="hasAnchor">
<a href="#logistic-mixed-effects-model-with-three-way-interaction" class="anchor"></a>Logistic Mixed Effects Model with Three-Way Interaction</h2>
<p>The last model does not produce very nice plots, but for the sake of demonstration, we fit a model with three interaction terms, including polynomial and spline terms.</p>
<div class="sourceCode" id="cb12"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">321</span>)
<span class="no">dat</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(
  <span class="kw">outcome</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span>(<span class="kw">n</span> <span class="kw">=</span> <span class="fl">100</span>, <span class="kw">size</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">prob</span> <span class="kw">=</span> <span class="fl">0.35</span>),
  <span class="kw">var_binom</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span>(<span class="kw">n</span> <span class="kw">=</span> <span class="fl">100</span>, <span class="kw">size</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">prob</span> <span class="kw">=</span> <span class="fl">0.5</span>),
  <span class="kw">var_cont</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="kw">n</span> <span class="kw">=</span> <span class="fl">100</span>, <span class="kw">mean</span> <span class="kw">=</span> <span class="fl">10</span>, <span class="kw">sd</span> <span class="kw">=</span> <span class="fl">7</span>),
  <span class="kw">var_cont2</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="kw">n</span> <span class="kw">=</span> <span class="fl">100</span>, <span class="kw">mean</span> <span class="kw">=</span> <span class="fl">5</span>, <span class="kw">sd</span> <span class="kw">=</span> <span class="fl">2</span>),
  <span class="kw">group</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="no">letters</span>[<span class="fl">1</span>:<span class="fl">4</span>], <span class="kw">size</span> <span class="kw">=</span> <span class="fl">100</span>, <span class="kw">replace</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
)


<span class="no">m4</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/glmer.html">glmer</a></span>(
  <span class="no">outcome</span> ~ <span class="no">var_binom</span> * <span class="fu"><a href="https://rdrr.io/r/stats/poly.html">poly</a></span>(<span class="no">var_cont</span>, <span class="kw">degree</span> <span class="kw">=</span> <span class="fl">2</span>) * <span class="fu"><a href="https://rdrr.io/r/splines/ns.html">ns</a></span>(<span class="no">var_cont2</span>, <span class="kw">df</span> <span class="kw">=</span> <span class="fl">3</span>) + (<span class="fl">1</span> <span class="kw">|</span> <span class="no">group</span>),
  <span class="kw">data</span> <span class="kw">=</span> <span class="no">dat</span>,
  <span class="kw">family</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html">binomial</a></span>(<span class="kw">link</span> <span class="kw">=</span> <span class="st">"logit"</span>)
)</pre></body></html></div>
<p>Since we have marginal effects for <em>var_cont</em> at the levels of <em>var_cont2</em> and <em>var_binom</em>, we not only have groups, but also facets to plot all three “dimensions”. Three-way interactions are plotted simply by speficying all terms in question in the <code>terms</code>-argument.</p>
<div class="sourceCode" id="cb13"><html><body><pre class="r"><span class="fu"><a href="../reference/ggpredict.html">ggpredict</a></span>(<span class="no">m4</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"var_cont [all]"</span>, <span class="st">"var_cont2"</span>, <span class="st">"var_binom"</span>)) <span class="kw">%&gt;%</span> <span class="fu"><a href="../reference/plot.html">plot</a></span>()</pre></body></html></div>
<p><img src="practical_logisticmixedmodel_files/figure-html/unnamed-chunk-11-1.png" width="672"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://github.com/strengejacke">Daniel Lüdecke</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
